<ion-content style="max-height: 100vh;" [fullscreen]="true">
  <ion-header collapse="condense" [translucent]="true">
    <ion-toolbar style="background-color: transparent;">
      <ion-title size="large">Home</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="background">

  </div>

  <div class="foreground">
    <ion-card style="background: transparent; box-shadow: none;">
      <ion-card-title class="white-text text-shadow text-title">Greetings, <strong>{{username}}!</strong></ion-card-title>
    </ion-card>

    <ion-card class="card-margin card-padding">
      <ion-card-subtitle>Get motivated!</ion-card-subtitle>
      <ion-card-content [ngSwitch]="hasStudyGoal">
        <ion-list *ngSwitchCase=true>

        </ion-list>

        <ion-card-title style="font-size: large;" *ngSwitchCase=false>Tap here to set your first <strong>study plan!</strong></ion-card-title>
      
      </ion-card-content>
    </ion-card>

    <ion-card class="card-margin card-padding">
      <ion-card-subtitle>Your notes</ion-card-subtitle>
      <ion-card-content style="flex-grow: 1;  min-height: 300px;">
          <ion-row style="display: flex; flex-wrap: nowrap; overflow-x: auto;">
            <ion-chip style="margin-left: 0px; white-space: nowrap; min-width: 110px;">‚≠êIn focus</ion-chip>
            <ion-chip style="white-space: nowrap; min-width: 50px;" *ngFor="let s of userSubjects">{{s}}</ion-chip>
          </ion-row>
          
          <ion-list style="flex-grow:1; overflow-y: scroll; " class="ion-no-padding" lines="inset">
            <ion-item [button]="true" (click)="loadNoteInViewerModal(note)" class="ion-no-padding" *ngFor="let note of noteList">
                  <!-- <ion-thumbnail slot="start">
                    <img alt="Silhouette of mountains" src="https://ionicframework.com/docs/img/demos/thumbnail.svg" />
                  </ion-thumbnail> -->
                  <ion-card-title><h2>{{note.name}}</h2></ion-card-title>
                  <ion-chip size="small" style="min-width: 48px;"><h3>60%</h3></ion-chip>
  
            </ion-item>
          </ion-list>

        
      </ion-card-content>

    </ion-card>

    <ion-fab>
      <ion-fab-button (click)="create_note()">
        <ion-icon name="add"></ion-icon>
      </ion-fab-button>
    </ion-fab>

    <!-- Note Viewer Modal -->
    <ion-modal (willDismiss)="noteViewerModalOpen=false" #noteViewerModal [isOpen]="noteViewerModalOpen">
      <ng-template>
        <ion-header style="box-shadow: none;">
          <!-- Note Viewer title bar-->
          <ion-toolbar>
            <ion-buttons slot="start">
              <ion-button (click)="dismissNoteViewerModal()"> <ion-icon name="chevron-back-outline"></ion-icon> </ion-button>
            </ion-buttons>
            <ion-buttons slot="end">
              <ion-button (click)="toggleNoteOptions()"> <ion-icon name="menu-outline"></ion-icon> </ion-button>
            </ion-buttons>
            <ion-title class="ion-no-padding">{{currentNote.name}}</ion-title>
          </ion-toolbar>
        </ion-header>

        <!-- Keyword card -->
        <ion-card class='ion-padding' style="white-space: nowrap; min-height: 80px; max-height: 120px; overflow-x: auto;">
          <ion-card-subtitle>Keywords <strong style="color: #606cff">(view flashcards)</strong></ion-card-subtitle>
          <ion-chip color="primary" *ngFor="let w of currentNoteContent.keywords" >{{w}}</ion-chip>
        </ion-card>

        <!-- Content card -->
        <ion-card class="ion-padding" style="overflow-y: auto;">
          <ion-row>
            <ion-card-subtitle class="ion-align-self-start">
              Content
            </ion-card-subtitle>
          </ion-row>

          <ion-card-content style="display: flex;">
            <div style="color: black;" #rtviewer id="rtviewer"></div>
            
          </ion-card-content>        
        </ion-card>

        <!-- Revision options menu -->
        <ion-grid style="margin: 0px; padding-top: 0px">
          <ion-row>
            <ion-col>
              <ion-button expand="block" class="ion-no-padding">Revise suggested parts</ion-button>
            </ion-col>
            <ion-col>
              <ion-button expand="block" fill="outline" class="ion-no-padding">Take full revision</ion-button>
            </ion-col>
            
          </ion-row>
        </ion-grid>


        <!-- Note Options popover -->
        <ion-popover (didDismiss)="toggleNoteOptions(false)" (click)="toggleNoteOptions(false)" #noteOptionsPopover [isOpen]="isPopoverOpen">
          <ng-template>
            <ion-button style="--box-shadow:none" (click)="handleNoteOptions('edit')">Edit</ion-button>
            <ion-button style="--box-shadow:none" (click)="handleNoteOptions('delete')" color="danger">Delete</ion-button>
          </ng-template>
        </ion-popover>

        <ion-content class="ion-padding">
        </ion-content>
      </ng-template>
      
    </ion-modal>

  </div>

</ion-content>
